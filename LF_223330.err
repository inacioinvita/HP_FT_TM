[INFO|configuration_utils.py:679] 2025-01-15 14:47:39,110 >> loading configuration file config.json from cache at /home/ivieira/.cache/huggingface/hub/models--meta-llama--Meta-Llama-3.1-8B-Instruct/snapshots/0e9e39f249a16976918f6564b8830bc894c89659/config.json
[INFO|configuration_utils.py:746] 2025-01-15 14:47:39,111 >> Model config LlamaConfig {
  "_name_or_path": "meta-llama/Meta-Llama-3.1-8B-Instruct",
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": [
    128001,
    128008,
    128009
  ],
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 4096,
  "initializer_range": 0.02,
  "intermediate_size": 14336,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 32,
  "num_hidden_layers": 32,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 8.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.46.1",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2211] 2025-01-15 14:47:39,313 >> loading file tokenizer.json from cache at /home/ivieira/.cache/huggingface/hub/models--meta-llama--Meta-Llama-3.1-8B-Instruct/snapshots/0e9e39f249a16976918f6564b8830bc894c89659/tokenizer.json
[INFO|tokenization_utils_base.py:2211] 2025-01-15 14:47:39,314 >> loading file tokenizer.model from cache at None
[INFO|tokenization_utils_base.py:2211] 2025-01-15 14:47:39,314 >> loading file added_tokens.json from cache at None
[INFO|tokenization_utils_base.py:2211] 2025-01-15 14:47:39,314 >> loading file special_tokens_map.json from cache at /home/ivieira/.cache/huggingface/hub/models--meta-llama--Meta-Llama-3.1-8B-Instruct/snapshots/0e9e39f249a16976918f6564b8830bc894c89659/special_tokens_map.json
[INFO|tokenization_utils_base.py:2211] 2025-01-15 14:47:39,314 >> loading file tokenizer_config.json from cache at /home/ivieira/.cache/huggingface/hub/models--meta-llama--Meta-Llama-3.1-8B-Instruct/snapshots/0e9e39f249a16976918f6564b8830bc894c89659/tokenizer_config.json
[INFO|tokenization_utils_base.py:2475] 2025-01-15 14:47:39,760 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|configuration_utils.py:679] 2025-01-15 14:47:40,958 >> loading configuration file config.json from cache at /home/ivieira/.cache/huggingface/hub/models--meta-llama--Meta-Llama-3.1-8B-Instruct/snapshots/0e9e39f249a16976918f6564b8830bc894c89659/config.json
[INFO|configuration_utils.py:746] 2025-01-15 14:47:40,960 >> Model config LlamaConfig {
  "_name_or_path": "meta-llama/Meta-Llama-3.1-8B-Instruct",
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": [
    128001,
    128008,
    128009
  ],
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 4096,
  "initializer_range": 0.02,
  "intermediate_size": 14336,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 32,
  "num_hidden_layers": 32,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 8.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.46.1",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2211] 2025-01-15 14:47:41,201 >> loading file tokenizer.json from cache at /home/ivieira/.cache/huggingface/hub/models--meta-llama--Meta-Llama-3.1-8B-Instruct/snapshots/0e9e39f249a16976918f6564b8830bc894c89659/tokenizer.json
[INFO|tokenization_utils_base.py:2211] 2025-01-15 14:47:41,201 >> loading file tokenizer.model from cache at None
[INFO|tokenization_utils_base.py:2211] 2025-01-15 14:47:41,201 >> loading file added_tokens.json from cache at None
[INFO|tokenization_utils_base.py:2211] 2025-01-15 14:47:41,202 >> loading file special_tokens_map.json from cache at /home/ivieira/.cache/huggingface/hub/models--meta-llama--Meta-Llama-3.1-8B-Instruct/snapshots/0e9e39f249a16976918f6564b8830bc894c89659/special_tokens_map.json
[INFO|tokenization_utils_base.py:2211] 2025-01-15 14:47:41,202 >> loading file tokenizer_config.json from cache at /home/ivieira/.cache/huggingface/hub/models--meta-llama--Meta-Llama-3.1-8B-Instruct/snapshots/0e9e39f249a16976918f6564b8830bc894c89659/tokenizer_config.json
[INFO|tokenization_utils_base.py:2475] 2025-01-15 14:47:41,643 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|configuration_utils.py:679] 2025-01-15 14:47:42,526 >> loading configuration file config.json from cache at /home/ivieira/.cache/huggingface/hub/models--meta-llama--Meta-Llama-3.1-8B-Instruct/snapshots/0e9e39f249a16976918f6564b8830bc894c89659/config.json
[INFO|configuration_utils.py:746] 2025-01-15 14:47:42,527 >> Model config LlamaConfig {
  "_name_or_path": "meta-llama/Meta-Llama-3.1-8B-Instruct",
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": [
    128001,
    128008,
    128009
  ],
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 4096,
  "initializer_range": 0.02,
  "intermediate_size": 14336,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 32,
  "num_hidden_layers": 32,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 8.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.46.1",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|modeling_utils.py:3937] 2025-01-15 14:47:42,629 >> loading weights file model.safetensors from cache at /home/ivieira/.cache/huggingface/hub/models--meta-llama--Meta-Llama-3.1-8B-Instruct/snapshots/0e9e39f249a16976918f6564b8830bc894c89659/model.safetensors.index.json
[INFO|modeling_utils.py:1670] 2025-01-15 14:47:42,629 >> Instantiating LlamaForCausalLM model under default dtype torch.bfloat16.
[INFO|configuration_utils.py:1096] 2025-01-15 14:47:42,631 >> Generate config GenerationConfig {
  "bos_token_id": 128000,
  "eos_token_id": [
    128001,
    128008,
    128009
  ]
}

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:03<00:09,  3.17s/it]Loading checkpoint shards:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:06<00:06,  3.12s/it]Loading checkpoint shards:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:09<00:03,  3.07s/it]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:09<00:00,  2.11s/it]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:09<00:00,  2.47s/it]
[INFO|modeling_utils.py:4800] 2025-01-15 14:47:52,671 >> All model checkpoint weights were used when initializing LlamaForCausalLM.

[INFO|modeling_utils.py:4808] 2025-01-15 14:47:52,671 >> All the weights of LlamaForCausalLM were initialized from the model checkpoint at meta-llama/Meta-Llama-3.1-8B-Instruct.
If your task is similar to the task the model of the checkpoint was trained on, you can already use LlamaForCausalLM for predictions without further training.
[INFO|configuration_utils.py:1051] 2025-01-15 14:47:52,861 >> loading configuration file generation_config.json from cache at /home/ivieira/.cache/huggingface/hub/models--meta-llama--Meta-Llama-3.1-8B-Instruct/snapshots/0e9e39f249a16976918f6564b8830bc894c89659/generation_config.json
[INFO|configuration_utils.py:1096] 2025-01-15 14:47:52,861 >> Generate config GenerationConfig {
  "bos_token_id": 128000,
  "do_sample": true,
  "eos_token_id": [
    128001,
    128008,
    128009
  ],
  "temperature": 0.6,
  "top_p": 0.9
}

[INFO|trainer.py:698] 2025-01-15 14:47:54,935 >> Using auto half precision backend
[INFO|trainer.py:2313] 2025-01-15 14:47:55,172 >> ***** Running training *****
[INFO|trainer.py:2314] 2025-01-15 14:47:55,172 >>   Num examples = 23,270
[INFO|trainer.py:2315] 2025-01-15 14:47:55,172 >>   Num Epochs = 1
[INFO|trainer.py:2316] 2025-01-15 14:47:55,172 >>   Instantaneous batch size per device = 32
[INFO|trainer.py:2319] 2025-01-15 14:47:55,172 >>   Total train batch size (w. parallel, distributed & accumulation) = 256
[INFO|trainer.py:2320] 2025-01-15 14:47:55,172 >>   Gradient Accumulation steps = 8
[INFO|trainer.py:2321] 2025-01-15 14:47:55,172 >>   Total optimization steps = 29
[INFO|trainer.py:2322] 2025-01-15 14:47:55,176 >>   Number of trainable parameters = 167,772,160
[INFO|integration_utils.py:812] 2025-01-15 14:47:55,181 >> Automatic Weights & Biases logging enabled, to disable set os.environ["WANDB_DISABLED"] = "true"
wandb: Currently logged in as: inaciovieira (inaciovieira-alpha-crc). Use `wandb login --relogin` to force relogin
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Tracking run with wandb version 0.19.2
wandb: Run data is saved locally in /home/ivieira/LLaMA-Factory/wandb/run-20250115_144755-4g8e1648
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run train_2025-01-15-14-47-32
wandb: ‚≠êÔ∏è View project at https://wandb.ai/inaciovieira-alpha-crc/llamafactory
wandb: üöÄ View run at https://wandb.ai/inaciovieira-alpha-crc/llamafactory/runs/4g8e1648
  0%|          | 0/29 [00:00<?, ?it/s]/home/ivieira/miniconda3/envs/lf-env/lib/python3.11/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/home/ivieira/miniconda3/envs/lf-env/lib/python3.11/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
  3%|‚ñé         | 1/29 [00:54<25:35, 54.84s/it]  7%|‚ñã         | 2/29 [01:58<27:04, 60.16s/it] 10%|‚ñà         | 3/29 [03:11<28:29, 65.76s/it] 14%|‚ñà‚ñç        | 4/29 [04:19<27:46, 66.65s/it] 17%|‚ñà‚ñã        | 5/29 [05:32<27:37, 69.05s/it] 21%|‚ñà‚ñà        | 6/29 [06:27<24:35, 64.14s/it] 24%|‚ñà‚ñà‚ñç       | 7/29 [07:41<24:47, 67.60s/it] 28%|‚ñà‚ñà‚ñä       | 8/29 [08:51<23:53, 68.24s/it] 31%|‚ñà‚ñà‚ñà       | 9/29 [09:56<22:23, 67.17s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 10/29 [10:51<20:07, 63.54s/it]                                                34%|‚ñà‚ñà‚ñà‚ñç      | 10/29 [10:51<20:07, 63.54s/it][INFO|trainer.py:4117] 2025-01-15 14:58:47,875 >> 
***** Running Evaluation *****
[INFO|trainer.py:4119] 2025-01-15 14:58:47,875 >>   Num examples = 2586
[INFO|trainer.py:4122] 2025-01-15 14:58:47,875 >>   Batch size = 16

  0%|          | 0/162 [00:00<?, ?it/s][A
  1%|          | 2/162 [00:00<00:39,  4.02it/s][A
  2%|‚ñè         | 3/162 [00:00<00:53,  2.97it/s][A
  2%|‚ñè         | 4/162 [00:01<01:02,  2.53it/s][A
  3%|‚ñé         | 5/162 [00:02<01:15,  2.09it/s][A
  4%|‚ñé         | 6/162 [00:02<01:13,  2.12it/s][A
  4%|‚ñç         | 7/162 [00:03<01:13,  2.12it/s][A
  5%|‚ñç         | 8/162 [00:03<01:20,  1.92it/s][A
  6%|‚ñå         | 9/162 [00:04<01:17,  1.97it/s][A
  6%|‚ñå         | 10/162 [00:04<01:24,  1.80it/s][A
  7%|‚ñã         | 11/162 [00:05<01:38,  1.54it/s][A
  7%|‚ñã         | 12/162 [00:06<01:28,  1.70it/s][A
  8%|‚ñä         | 13/162 [00:06<01:27,  1.70it/s][A
  9%|‚ñä         | 14/162 [00:07<01:23,  1.77it/s][A
  9%|‚ñâ         | 15/162 [00:07<01:18,  1.87it/s][A
 10%|‚ñâ         | 16/162 [00:08<01:14,  1.95it/s][A
 10%|‚ñà         | 17/162 [00:08<01:15,  1.91it/s][A
 11%|‚ñà         | 18/162 [00:09<01:20,  1.78it/s][A
 12%|‚ñà‚ñè        | 19/162 [00:09<01:18,  1.83it/s][A
 12%|‚ñà‚ñè        | 20/162 [00:10<01:23,  1.71it/s][A
 13%|‚ñà‚ñé        | 21/162 [00:11<01:18,  1.79it/s][A
 14%|‚ñà‚ñé        | 22/162 [00:11<01:13,  1.91it/s][A
 14%|‚ñà‚ñç        | 23/162 [00:12<01:23,  1.66it/s][A
 15%|‚ñà‚ñç        | 24/162 [00:12<01:19,  1.74it/s][A
 15%|‚ñà‚ñå        | 25/162 [00:13<01:16,  1.80it/s][A
 16%|‚ñà‚ñå        | 26/162 [00:13<01:13,  1.86it/s][A
 17%|‚ñà‚ñã        | 27/162 [00:15<01:50,  1.22it/s][A
 17%|‚ñà‚ñã        | 28/162 [00:15<01:36,  1.39it/s][A
 18%|‚ñà‚ñä        | 29/162 [00:16<01:25,  1.55it/s][A
 19%|‚ñà‚ñä        | 30/162 [00:16<01:21,  1.61it/s][A
 19%|‚ñà‚ñâ        | 31/162 [00:17<01:16,  1.70it/s][A
 20%|‚ñà‚ñâ        | 32/162 [00:17<01:11,  1.82it/s][A
 20%|‚ñà‚ñà        | 33/162 [00:18<01:07,  1.90it/s][A
 21%|‚ñà‚ñà        | 34/162 [00:18<01:15,  1.70it/s][A
 22%|‚ñà‚ñà‚ñè       | 35/162 [00:19<01:10,  1.80it/s][A
 22%|‚ñà‚ñà‚ñè       | 36/162 [00:20<01:49,  1.16it/s][A
 23%|‚ñà‚ñà‚ñé       | 37/162 [00:21<01:34,  1.32it/s][A
 23%|‚ñà‚ñà‚ñé       | 38/162 [00:21<01:24,  1.47it/s][A
 24%|‚ñà‚ñà‚ñç       | 39/162 [00:22<01:25,  1.44it/s][A
 25%|‚ñà‚ñà‚ñç       | 40/162 [00:23<01:14,  1.63it/s][A
 25%|‚ñà‚ñà‚ñå       | 41/162 [00:23<01:14,  1.62it/s][A
 26%|‚ñà‚ñà‚ñå       | 42/162 [00:24<01:07,  1.78it/s][A
 27%|‚ñà‚ñà‚ñã       | 43/162 [00:24<01:04,  1.85it/s][A
 27%|‚ñà‚ñà‚ñã       | 44/162 [00:25<01:10,  1.68it/s][A
 28%|‚ñà‚ñà‚ñä       | 45/162 [00:25<01:05,  1.77it/s][A
 28%|‚ñà‚ñà‚ñä       | 46/162 [00:26<01:02,  1.86it/s][A
 29%|‚ñà‚ñà‚ñâ       | 47/162 [00:26<01:02,  1.85it/s][A
 30%|‚ñà‚ñà‚ñâ       | 48/162 [00:27<01:01,  1.85it/s][A
 30%|‚ñà‚ñà‚ñà       | 49/162 [00:27<00:58,  1.94it/s][A
 31%|‚ñà‚ñà‚ñà       | 50/162 [00:28<00:58,  1.91it/s][A
 31%|‚ñà‚ñà‚ñà‚ñè      | 51/162 [00:28<00:55,  1.99it/s][A
 32%|‚ñà‚ñà‚ñà‚ñè      | 52/162 [00:29<00:55,  2.00it/s][A
 33%|‚ñà‚ñà‚ñà‚ñé      | 53/162 [00:29<00:53,  2.05it/s][A
 33%|‚ñà‚ñà‚ñà‚ñé      | 54/162 [00:30<00:52,  2.07it/s][A
 34%|‚ñà‚ñà‚ñà‚ñç      | 55/162 [00:30<00:49,  2.14it/s][A
 35%|‚ñà‚ñà‚ñà‚ñç      | 56/162 [00:31<00:49,  2.13it/s][A
 35%|‚ñà‚ñà‚ñà‚ñå      | 57/162 [00:31<00:51,  2.03it/s][A
 36%|‚ñà‚ñà‚ñà‚ñå      | 58/162 [00:32<00:50,  2.05it/s][A
 36%|‚ñà‚ñà‚ñà‚ñã      | 59/162 [00:32<00:53,  1.93it/s][A
 37%|‚ñà‚ñà‚ñà‚ñã      | 60/162 [00:33<00:52,  1.94it/s][A
 38%|‚ñà‚ñà‚ñà‚ñä      | 61/162 [00:33<00:51,  1.96it/s][A
 38%|‚ñà‚ñà‚ñà‚ñä      | 62/162 [00:34<00:49,  2.00it/s][A
 39%|‚ñà‚ñà‚ñà‚ñâ      | 63/162 [00:34<00:48,  2.03it/s][A
 40%|‚ñà‚ñà‚ñà‚ñâ      | 64/162 [00:35<00:50,  1.93it/s][A
 40%|‚ñà‚ñà‚ñà‚ñà      | 65/162 [00:35<00:49,  1.94it/s][A
 41%|‚ñà‚ñà‚ñà‚ñà      | 66/162 [00:36<00:47,  2.01it/s][A
 41%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 67/162 [00:36<00:48,  1.95it/s][A
 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 68/162 [00:37<00:45,  2.05it/s][A
 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 69/162 [00:37<00:47,  1.96it/s][A
 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 70/162 [00:38<00:46,  1.96it/s][A
 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 71/162 [00:38<00:45,  2.02it/s][A
 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 72/162 [00:39<00:56,  1.59it/s][A
 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 73/162 [00:40<00:51,  1.72it/s][A
 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 74/162 [00:40<00:49,  1.78it/s][A
 46%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 75/162 [00:41<00:45,  1.90it/s][A
 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 76/162 [00:41<00:47,  1.80it/s][A
 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 77/162 [00:42<00:50,  1.70it/s][A
 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 78/162 [00:44<01:26,  1.03s/it][A
 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 79/162 [00:45<01:10,  1.18it/s][A
 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 80/162 [00:45<01:02,  1.31it/s][A
 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 81/162 [00:46<00:55,  1.46it/s][A
 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 82/162 [00:46<00:49,  1.61it/s][A
 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 83/162 [00:47<00:44,  1.76it/s][A
 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 84/162 [00:47<00:41,  1.87it/s][A
 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 85/162 [00:47<00:38,  1.98it/s][A
 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 86/162 [00:48<00:38,  1.96it/s][A
 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 87/162 [00:49<00:46,  1.61it/s][A
 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 88/162 [00:49<00:43,  1.70it/s][A
 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 89/162 [00:50<00:39,  1.83it/s][A
 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 90/162 [00:50<00:39,  1.82it/s][A
 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 91/162 [00:51<00:37,  1.87it/s][A
 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 92/162 [00:51<00:35,  1.96it/s][A
 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 93/162 [00:52<00:33,  2.04it/s][A
 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 94/162 [00:52<00:33,  2.06it/s][A
 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 95/162 [00:53<00:31,  2.11it/s][A
 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 96/162 [00:53<00:31,  2.06it/s][A
 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 97/162 [00:54<00:31,  2.03it/s][A
 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 98/162 [00:54<00:31,  2.06it/s][A
 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 99/162 [00:55<00:29,  2.14it/s][A
 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 100/162 [00:55<00:30,  2.06it/s][A
 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 101/162 [00:56<00:29,  2.07it/s][A
 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 102/162 [00:56<00:28,  2.12it/s][A
 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 103/162 [00:57<00:30,  1.97it/s][A
 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 104/162 [00:57<00:28,  2.01it/s][A
 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 105/162 [00:58<00:28,  1.99it/s][A
 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 106/162 [00:58<00:26,  2.08it/s][A
 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 107/162 [00:58<00:25,  2.14it/s][A
 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 108/162 [00:59<00:25,  2.15it/s][A
 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 109/162 [00:59<00:24,  2.13it/s][A
 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 110/162 [01:00<00:24,  2.15it/s][A
 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 111/162 [01:00<00:23,  2.18it/s][A
 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 112/162 [01:01<00:23,  2.11it/s][A
 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 113/162 [01:01<00:22,  2.16it/s][A
 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 114/162 [01:02<00:21,  2.21it/s][A
 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 115/162 [01:02<00:21,  2.18it/s][A
 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 116/162 [01:03<00:20,  2.25it/s][A
 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 117/162 [01:03<00:20,  2.18it/s][A
 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 118/162 [01:04<00:20,  2.11it/s][A
 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 119/162 [01:04<00:21,  2.02it/s][A
 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 120/162 [01:05<00:20,  2.06it/s][A
 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 121/162 [01:05<00:20,  1.99it/s][A
 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 122/162 [01:06<00:20,  1.98it/s][A
 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 123/162 [01:06<00:19,  2.02it/s][A
 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 124/162 [01:07<00:18,  2.02it/s][A
 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 125/162 [01:07<00:18,  2.00it/s][A
 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 126/162 [01:08<00:17,  2.05it/s][A
 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 127/162 [01:08<00:16,  2.11it/s][A
 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 128/162 [01:09<00:16,  2.06it/s][A
 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 129/162 [01:09<00:16,  2.03it/s][A
 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 130/162 [01:09<00:15,  2.11it/s][A
 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 131/162 [01:10<00:15,  1.96it/s][A
 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 132/162 [01:11<00:15,  1.98it/s][A
 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 133/162 [01:11<00:14,  1.99it/s][A
 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 134/162 [01:11<00:13,  2.04it/s][A
 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 135/162 [01:12<00:12,  2.10it/s][A
 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 136/162 [01:12<00:12,  2.03it/s][A
 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 137/162 [01:13<00:12,  1.93it/s][A
 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 138/162 [01:14<00:12,  1.99it/s][A
 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 139/162 [01:14<00:11,  2.06it/s][A
 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 140/162 [01:14<00:10,  2.14it/s][A
 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 141/162 [01:15<00:10,  2.08it/s][A
 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 142/162 [01:15<00:09,  2.05it/s][A
 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 143/162 [01:16<00:09,  2.02it/s][A
 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 144/162 [01:16<00:09,  1.96it/s][A
 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 145/162 [01:17<00:08,  2.00it/s][A
 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 146/162 [01:17<00:07,  2.07it/s][A
 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 147/162 [01:18<00:08,  1.76it/s][A
 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 148/162 [01:19<00:07,  1.83it/s][A
 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 149/162 [01:19<00:06,  1.94it/s][A
 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 150/162 [01:20<00:06,  1.96it/s][A
 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 151/162 [01:20<00:05,  2.00it/s][A
 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 152/162 [01:21<00:05,  1.90it/s][A
 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 153/162 [01:21<00:04,  1.96it/s][A
 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 154/162 [01:22<00:03,  2.01it/s][A
 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 155/162 [01:22<00:03,  1.98it/s][A
 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 156/162 [01:23<00:02,  2.07it/s][A
 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 157/162 [01:23<00:02,  1.82it/s][A
 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 158/162 [01:24<00:02,  1.93it/s][A
 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 159/162 [01:24<00:01,  1.98it/s][A
 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 160/162 [01:25<00:01,  1.99it/s][A
 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 161/162 [01:25<00:00,  1.96it/s][A
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 162/162 [01:26<00:00,  2.19it/s][A                                               
                                                 [A 34%|‚ñà‚ñà‚ñà‚ñç      | 10/29 [12:18<20:07, 63.54s/it]
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 162/162 [01:26<00:00,  2.19it/s][A
                                                 [A[INFO|trainer.py:3801] 2025-01-15 15:00:14,401 >> Saving model checkpoint to saves/Llama-3.1-8B-Instruct/lora/train_2025-01-15-14-47-32/checkpoint-10
[INFO|configuration_utils.py:679] 2025-01-15 15:00:14,836 >> loading configuration file config.json from cache at /home/ivieira/.cache/huggingface/hub/models--meta-llama--Meta-Llama-3.1-8B-Instruct/snapshots/0e9e39f249a16976918f6564b8830bc894c89659/config.json
[INFO|configuration_utils.py:746] 2025-01-15 15:00:14,838 >> Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 128000,
  "eos_token_id": [
    128001,
    128008,
    128009
  ],
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 4096,
  "initializer_range": 0.02,
  "intermediate_size": 14336,
  "max_position_embeddings": 131072,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 32,
  "num_hidden_layers": 32,
  "num_key_value_heads": 8,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": {
    "factor": 8.0,
    "high_freq_factor": 4.0,
    "low_freq_factor": 1.0,
    "original_max_position_embeddings": 8192,
    "rope_type": "llama3"
  },
  "rope_theta": 500000.0,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.46.1",
  "use_cache": true,
  "vocab_size": 128256
}

[INFO|tokenization_utils_base.py:2646] 2025-01-15 15:00:15,537 >> tokenizer config file saved in saves/Llama-3.1-8B-Instruct/lora/train_2025-01-15-14-47-32/checkpoint-10/tokenizer_config.json
[INFO|tokenization_utils_base.py:2655] 2025-01-15 15:00:15,538 >> Special tokens file saved in saves/Llama-3.1-8B-Instruct/lora/train_2025-01-15-14-47-32/checkpoint-10/special_tokens_map.json
/home/ivieira/miniconda3/envs/lf-env/lib/python3.11/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
/home/ivieira/miniconda3/envs/lf-env/lib/python3.11/site-packages/bitsandbytes/autograd/_functions.py:316: UserWarning: MatMul8bitLt: inputs will be cast from torch.bfloat16 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
 38%|‚ñà‚ñà‚ñà‚ñä      | 11/29 [13:36<28:21, 94.51s/it] 41%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 12/29 [14:54<25:21, 89.51s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 13/29 [16:07<22:30, 84.38s/it]slurmstepd-g128: error: *** JOB 223330 ON g128 CANCELLED AT 2025-01-15T15:04:34 ***
