Found existing installation: torch 2.5.1
Uninstalling torch-2.5.1:
  Successfully uninstalled torch-2.5.1
Found existing installation: torchvision 0.20.1
Uninstalling torchvision-0.20.1:
  Successfully uninstalled torchvision-0.20.1
Found existing installation: torchaudio 2.5.1
Uninstalling torchaudio-2.5.1:
  Successfully uninstalled torchaudio-2.5.1
WARNING: Skipping bitsandbytes as it is not installed.
=== Cleaning environment ===
Found existing installation: torch 2.5.1+cu121
Uninstalling torch-2.5.1+cu121:
  Successfully uninstalled torch-2.5.1+cu121
WARNING: Skipping torchvision as it is not installed.
WARNING: Skipping torchaudio as it is not installed.
Found existing installation: triton 3.1.0
Uninstalling triton-3.1.0:
  Successfully uninstalled triton-3.1.0
WARNING: Skipping torchtriton as it is not installed.

PackagesNotFoundError: The following packages are missing from the target environment:
  - cuda-toolkit
  - triton


=== Environment cleaned ===
=== Installing PyTorch with CUDA support ===
Looking in indexes: https://download.pytorch.org/whl/cu121
Collecting torch
  Downloading https://download.pytorch.org/whl/cu121/torch-2.5.1%2Bcu121-cp312-cp312-linux_x86_64.whl (780.4 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 780.4/780.4 MB 117.1 MB/s eta 0:00:00
Requirement already satisfied: filelock in /home/ivieira/.local/lib/python3.12/site-packages (from torch) (3.16.1)
Requirement already satisfied: typing-extensions>=4.8.0 in /home/ivieira/.local/lib/python3.12/site-packages (from torch) (4.12.2)
Requirement already satisfied: networkx in /home/ivieira/.local/lib/python3.12/site-packages (from torch) (3.4.2)
Requirement already satisfied: jinja2 in /home/ivieira/.local/lib/python3.12/site-packages (from torch) (3.1.4)
Requirement already satisfied: fsspec in /home/ivieira/.local/lib/python3.12/site-packages (from torch) (2024.9.0)
Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.1.105 in /home/ivieira/mambaforge/lib/python3.12/site-packages (from torch) (12.1.105)
Requirement already satisfied: nvidia-cuda-runtime-cu12==12.1.105 in /home/ivieira/mambaforge/lib/python3.12/site-packages (from torch) (12.1.105)
Requirement already satisfied: nvidia-cuda-cupti-cu12==12.1.105 in /home/ivieira/mambaforge/lib/python3.12/site-packages (from torch) (12.1.105)
Requirement already satisfied: nvidia-cudnn-cu12==9.1.0.70 in /home/ivieira/.local/lib/python3.12/site-packages (from torch) (9.1.0.70)
Requirement already satisfied: nvidia-cublas-cu12==12.1.3.1 in /home/ivieira/mambaforge/lib/python3.12/site-packages (from torch) (12.1.3.1)
Requirement already satisfied: nvidia-cufft-cu12==11.0.2.54 in /home/ivieira/mambaforge/lib/python3.12/site-packages (from torch) (11.0.2.54)
Requirement already satisfied: nvidia-curand-cu12==10.3.2.106 in /home/ivieira/mambaforge/lib/python3.12/site-packages (from torch) (10.3.2.106)
Requirement already satisfied: nvidia-cusolver-cu12==11.4.5.107 in /home/ivieira/mambaforge/lib/python3.12/site-packages (from torch) (11.4.5.107)
Requirement already satisfied: nvidia-cusparse-cu12==12.1.0.106 in /home/ivieira/mambaforge/lib/python3.12/site-packages (from torch) (12.1.0.106)
Requirement already satisfied: nvidia-nccl-cu12==2.21.5 in /home/ivieira/.local/lib/python3.12/site-packages (from torch) (2.21.5)
Requirement already satisfied: nvidia-nvtx-cu12==12.1.105 in /home/ivieira/mambaforge/lib/python3.12/site-packages (from torch) (12.1.105)
Requirement already satisfied: triton==3.1.0 in /home/ivieira/mambaforge/lib/python3.12/site-packages (from torch) (3.1.0)
Requirement already satisfied: setuptools in /home/ivieira/mambaforge/lib/python3.12/site-packages (from torch) (75.3.0)
Requirement already satisfied: sympy==1.13.1 in /home/ivieira/.local/lib/python3.12/site-packages (from torch) (1.13.1)
Requirement already satisfied: nvidia-nvjitlink-cu12 in /home/ivieira/.local/lib/python3.12/site-packages (from nvidia-cusolver-cu12==11.4.5.107->torch) (12.4.127)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /home/ivieira/.local/lib/python3.12/site-packages (from sympy==1.13.1->torch) (1.3.0)
Requirement already satisfied: MarkupSafe>=2.0 in /home/ivieira/.local/lib/python3.12/site-packages (from jinja2->torch) (3.0.2)
Installing collected packages: torch
Successfully installed torch-2.5.1+cu121
=== Verifying PyTorch CUDA Installation ===
Traceback (most recent call last):
  File "<string>", line 2, in <module>
  File "/home/ivieira/mambaforge/lib/python3.12/site-packages/torch/__init__.py", line 367, in <module>
    from torch._C import *  # noqa: F403
    ^^^^^^^^^^^^^^^^^^^^^^
ImportError: libcudnn.so.9: cannot open shared object file: No such file or directory
PyTorch CUDA installation failed, trying conda...
Channels:
 - pytorch
 - nvidia
 - conda-forge
Platform: linux-64
Collecting package metadata (repodata.json): ...working... done
Solving environment: ...working... done

# All requested packages already installed.

Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/ivieira/mambaforge/lib/python3.12/site-packages/torch/__init__.py", line 367, in <module>
    from torch._C import *  # noqa: F403
    ^^^^^^^^^^^^^^^^^^^^^^
ImportError: libcudnn.so.9: cannot open shared object file: No such file or directory
