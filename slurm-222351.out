ERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
huggingface-hub 0.27.1 requires requests, which is not installed.
mlflow 2.17.2 requires pyarrow<18,>=4.0.0, which is not installed.
mlflow-skinny 2.17.2 requires importlib-metadata!=4.7.0,<9,>=3.7.0, which is not installed.
mlflow-skinny 2.17.2 requires requests<3,>=2.17.3, which is not installed.
transformers 4.46.3 requires regex!=2019.12.17, which is not installed.
transformers 4.46.3 requires requests, which is not installed.
trl 0.11.4 requires accelerate, which is not installed.
trl 0.11.4 requires datasets, which is not installed.
trl 0.11.4 requires tyro>=0.5.11, which is not installed.
unbabel-comet 2.2.4 requires torchmetrics<0.11.0,>=0.10.2, but you have torchmetrics 1.5.2 which is incompatible.
Looking in indexes: https://download.pytorch.org/whl/cu121
Requirement already satisfied: torch in /home/ivieira/mambaforge/envs/my-pip-env/lib/python3.8/site-packages (2.4.1+cu121)
Requirement already satisfied: filelock in /home/ivieira/mambaforge/envs/my-pip-env/lib/python3.8/site-packages (from torch) (3.13.1)
Requirement already satisfied: typing-extensions>=4.8.0 in /home/ivieira/mambaforge/envs/my-pip-env/lib/python3.8/site-packages (from torch) (4.9.0)
Requirement already satisfied: sympy in /home/ivieira/mambaforge/envs/my-pip-env/lib/python3.8/site-packages (from torch) (1.13.1)
Requirement already satisfied: networkx in /home/ivieira/mambaforge/envs/my-pip-env/lib/python3.8/site-packages (from torch) (3.0)
Requirement already satisfied: jinja2 in /home/ivieira/mambaforge/envs/my-pip-env/lib/python3.8/site-packages (from torch) (3.1.3)
Requirement already satisfied: fsspec in /home/ivieira/mambaforge/envs/my-pip-env/lib/python3.8/site-packages (from torch) (2024.2.0)
Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.1.105 in /home/ivieira/mambaforge/envs/my-pip-env/lib/python3.8/site-packages (from torch) (12.1.105)
Requirement already satisfied: nvidia-cuda-runtime-cu12==12.1.105 in /home/ivieira/mambaforge/envs/my-pip-env/lib/python3.8/site-packages (from torch) (12.1.105)
Requirement already satisfied: nvidia-cuda-cupti-cu12==12.1.105 in /home/ivieira/mambaforge/envs/my-pip-env/lib/python3.8/site-packages (from torch) (12.1.105)
Requirement already satisfied: nvidia-cudnn-cu12==9.1.0.70 in /home/ivieira/mambaforge/envs/my-pip-env/lib/python3.8/site-packages (from torch) (9.1.0.70)
Requirement already satisfied: nvidia-cublas-cu12==12.1.3.1 in /home/ivieira/mambaforge/envs/my-pip-env/lib/python3.8/site-packages (from torch) (12.1.3.1)
Requirement already satisfied: nvidia-cufft-cu12==11.0.2.54 in /home/ivieira/mambaforge/envs/my-pip-env/lib/python3.8/site-packages (from torch) (11.0.2.54)
Requirement already satisfied: nvidia-curand-cu12==10.3.2.106 in /home/ivieira/mambaforge/envs/my-pip-env/lib/python3.8/site-packages (from torch) (10.3.2.106)
Requirement already satisfied: nvidia-cusolver-cu12==11.4.5.107 in /home/ivieira/mambaforge/envs/my-pip-env/lib/python3.8/site-packages (from torch) (11.4.5.107)
Requirement already satisfied: nvidia-cusparse-cu12==12.1.0.106 in /home/ivieira/mambaforge/envs/my-pip-env/lib/python3.8/site-packages (from torch) (12.1.0.106)
Requirement already satisfied: nvidia-nccl-cu12==2.20.5 in /home/ivieira/mambaforge/envs/my-pip-env/lib/python3.8/site-packages (from torch) (2.20.5)
Requirement already satisfied: nvidia-nvtx-cu12==12.1.105 in /home/ivieira/mambaforge/envs/my-pip-env/lib/python3.8/site-packages (from torch) (12.1.105)
Requirement already satisfied: triton==3.0.0 in /home/ivieira/mambaforge/envs/my-pip-env/lib/python3.8/site-packages (from torch) (3.0.0)
Requirement already satisfied: nvidia-nvjitlink-cu12 in /home/ivieira/mambaforge/envs/my-pip-env/lib/python3.8/site-packages (from nvidia-cusolver-cu12==11.4.5.107->torch) (12.1.105)
Requirement already satisfied: MarkupSafe>=2.0 in /home/ivieira/mambaforge/envs/my-pip-env/lib/python3.8/site-packages (from jinja2->torch) (2.1.5)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /home/ivieira/mambaforge/envs/my-pip-env/lib/python3.8/site-packages (from sympy->torch) (1.3.0)
ERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
transformers 4.46.3 requires regex!=2019.12.17, which is not installed.
unbabel-comet 2.2.4 requires torchmetrics<0.11.0,>=0.10.2, but you have torchmetrics 1.5.2 which is incompatible.
Traceback (most recent call last):
  File "BALS_trainer.py", line 6, in <module>
    from peft import LoraConfig, get_peft_model, prepare_model_for_kbit_training
ModuleNotFoundError: No module named 'peft'
