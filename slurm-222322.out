Found existing installation: torch 2.5.1
Uninstalling torch-2.5.1:
  Successfully uninstalled torch-2.5.1
WARNING: Skipping torchvision as it is not installed.
WARNING: Skipping torchaudio as it is not installed.
Found existing installation: bitsandbytes 0.44.1
Uninstalling bitsandbytes-0.44.1:
  Successfully uninstalled bitsandbytes-0.44.1
=== Cleaning environment ===
WARNING: Skipping torch as it is not installed.
WARNING: Skipping torchvision as it is not installed.
WARNING: Skipping torchaudio as it is not installed.
Found existing installation: triton 3.1.0
Uninstalling triton-3.1.0:
  Successfully uninstalled triton-3.1.0
WARNING: Skipping torchtriton as it is not installed.

PackagesNotFoundError: The following packages are missing from the target environment:
  - torchtriton
  - torchaudio
  - triton
  - cuda-toolkit
  - pytorch
  - torchvision
  - pytorch-cuda


=== Environment cleaned ===
=== Installing PyTorch with CUDA support ===
Looking in indexes: https://download.pytorch.org/whl/cu121
Collecting torch
  Downloading https://download.pytorch.org/whl/cu121/torch-2.5.1%2Bcu121-cp312-cp312-linux_x86_64.whl (780.4 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 780.4/780.4 MB 105.8 MB/s eta 0:00:00
Requirement already satisfied: filelock in /home/ivieira/.local/lib/python3.12/site-packages (from torch) (3.16.1)
Requirement already satisfied: typing-extensions>=4.8.0 in /home/ivieira/.local/lib/python3.12/site-packages (from torch) (4.12.2)
Requirement already satisfied: networkx in /home/ivieira/.local/lib/python3.12/site-packages (from torch) (3.4.2)
Requirement already satisfied: jinja2 in /home/ivieira/.local/lib/python3.12/site-packages (from torch) (3.1.4)
Requirement already satisfied: fsspec in /home/ivieira/.local/lib/python3.12/site-packages (from torch) (2024.9.0)
Collecting nvidia-cuda-nvrtc-cu12==12.1.105 (from torch)
  Downloading https://download.pytorch.org/whl/cu121/nvidia_cuda_nvrtc_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (23.7 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 23.7/23.7 MB 75.3 MB/s eta 0:00:00
Collecting nvidia-cuda-runtime-cu12==12.1.105 (from torch)
  Downloading https://download.pytorch.org/whl/cu121/nvidia_cuda_runtime_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (823 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 823.6/823.6 kB 80.2 MB/s eta 0:00:00
Collecting nvidia-cuda-cupti-cu12==12.1.105 (from torch)
  Downloading https://download.pytorch.org/whl/cu121/nvidia_cuda_cupti_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (14.1 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 14.1/14.1 MB 120.2 MB/s eta 0:00:00
Requirement already satisfied: nvidia-cudnn-cu12==9.1.0.70 in /home/ivieira/.local/lib/python3.12/site-packages (from torch) (9.1.0.70)
Collecting nvidia-cublas-cu12==12.1.3.1 (from torch)
  Downloading https://download.pytorch.org/whl/cu121/nvidia_cublas_cu12-12.1.3.1-py3-none-manylinux1_x86_64.whl (410.6 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 410.6/410.6 MB 108.1 MB/s eta 0:00:00
Collecting nvidia-cufft-cu12==11.0.2.54 (from torch)
  Downloading https://download.pytorch.org/whl/cu121/nvidia_cufft_cu12-11.0.2.54-py3-none-manylinux1_x86_64.whl (121.6 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 121.6/121.6 MB 117.1 MB/s eta 0:00:00
Collecting nvidia-curand-cu12==10.3.2.106 (from torch)
  Downloading https://download.pytorch.org/whl/cu121/nvidia_curand_cu12-10.3.2.106-py3-none-manylinux1_x86_64.whl (56.5 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 56.5/56.5 MB 85.0 MB/s eta 0:00:00
Collecting nvidia-cusolver-cu12==11.4.5.107 (from torch)
  Downloading https://download.pytorch.org/whl/cu121/nvidia_cusolver_cu12-11.4.5.107-py3-none-manylinux1_x86_64.whl (124.2 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 124.2/124.2 MB 117.1 MB/s eta 0:00:00
Collecting nvidia-cusparse-cu12==12.1.0.106 (from torch)
  Downloading https://download.pytorch.org/whl/cu121/nvidia_cusparse_cu12-12.1.0.106-py3-none-manylinux1_x86_64.whl (196.0 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 196.0/196.0 MB 104.6 MB/s eta 0:00:00
Requirement already satisfied: nvidia-nccl-cu12==2.21.5 in /home/ivieira/.local/lib/python3.12/site-packages (from torch) (2.21.5)
Collecting nvidia-nvtx-cu12==12.1.105 (from torch)
  Downloading https://download.pytorch.org/whl/cu121/nvidia_nvtx_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (99 kB)
Collecting triton==3.1.0 (from torch)
  Downloading https://download.pytorch.org/whl/triton-3.1.0-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (209.6 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 209.6/209.6 MB 117.3 MB/s eta 0:00:00
Requirement already satisfied: setuptools in /home/ivieira/mambaforge/lib/python3.12/site-packages (from torch) (75.3.0)
Requirement already satisfied: sympy==1.13.1 in /home/ivieira/.local/lib/python3.12/site-packages (from torch) (1.13.1)
Requirement already satisfied: nvidia-nvjitlink-cu12 in /home/ivieira/.local/lib/python3.12/site-packages (from nvidia-cusolver-cu12==11.4.5.107->torch) (12.4.127)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /home/ivieira/.local/lib/python3.12/site-packages (from sympy==1.13.1->torch) (1.3.0)
Requirement already satisfied: MarkupSafe>=2.0 in /home/ivieira/.local/lib/python3.12/site-packages (from jinja2->torch) (3.0.2)
Installing collected packages: triton, nvidia-nvtx-cu12, nvidia-cusparse-cu12, nvidia-curand-cu12, nvidia-cufft-cu12, nvidia-cuda-runtime-cu12, nvidia-cuda-nvrtc-cu12, nvidia-cuda-cupti-cu12, nvidia-cublas-cu12, nvidia-cusolver-cu12, torch
  Attempting uninstall: nvidia-nvtx-cu12
    Found existing installation: nvidia-nvtx-cu12 12.4.127
    Uninstalling nvidia-nvtx-cu12-12.4.127:
      Successfully uninstalled nvidia-nvtx-cu12-12.4.127
  Attempting uninstall: nvidia-cusparse-cu12
    Found existing installation: nvidia-cusparse-cu12 12.3.1.170
    Uninstalling nvidia-cusparse-cu12-12.3.1.170:
      Successfully uninstalled nvidia-cusparse-cu12-12.3.1.170
  Attempting uninstall: nvidia-curand-cu12
    Found existing installation: nvidia-curand-cu12 10.3.5.147
    Uninstalling nvidia-curand-cu12-10.3.5.147:
      Successfully uninstalled nvidia-curand-cu12-10.3.5.147
  Attempting uninstall: nvidia-cufft-cu12
    Found existing installation: nvidia-cufft-cu12 11.2.1.3
    Uninstalling nvidia-cufft-cu12-11.2.1.3:
      Successfully uninstalled nvidia-cufft-cu12-11.2.1.3
  Attempting uninstall: nvidia-cuda-runtime-cu12
    Found existing installation: nvidia-cuda-runtime-cu12 12.4.127
    Uninstalling nvidia-cuda-runtime-cu12-12.4.127:
      Successfully uninstalled nvidia-cuda-runtime-cu12-12.4.127
  Attempting uninstall: nvidia-cuda-nvrtc-cu12
    Found existing installation: nvidia-cuda-nvrtc-cu12 12.4.127
    Uninstalling nvidia-cuda-nvrtc-cu12-12.4.127:
      Successfully uninstalled nvidia-cuda-nvrtc-cu12-12.4.127
  Attempting uninstall: nvidia-cuda-cupti-cu12
    Found existing installation: nvidia-cuda-cupti-cu12 12.4.127
    Uninstalling nvidia-cuda-cupti-cu12-12.4.127:
      Successfully uninstalled nvidia-cuda-cupti-cu12-12.4.127
  Attempting uninstall: nvidia-cublas-cu12
    Found existing installation: nvidia-cublas-cu12 12.4.5.8
    Uninstalling nvidia-cublas-cu12-12.4.5.8:
      Successfully uninstalled nvidia-cublas-cu12-12.4.5.8
  Attempting uninstall: nvidia-cusolver-cu12
    Found existing installation: nvidia-cusolver-cu12 11.6.1.9
    Uninstalling nvidia-cusolver-cu12-11.6.1.9:
      Successfully uninstalled nvidia-cusolver-cu12-11.6.1.9
Successfully installed nvidia-cublas-cu12-12.1.3.1 nvidia-cuda-cupti-cu12-12.1.105 nvidia-cuda-nvrtc-cu12-12.1.105 nvidia-cuda-runtime-cu12-12.1.105 nvidia-cufft-cu12-11.0.2.54 nvidia-curand-cu12-10.3.2.106 nvidia-cusolver-cu12-11.4.5.107 nvidia-cusparse-cu12-12.1.0.106 nvidia-nvtx-cu12-12.1.105 torch-2.5.1+cu121 triton-3.1.0
=== Verifying PyTorch CUDA Installation ===
Traceback (most recent call last):
  File "<string>", line 2, in <module>
  File "/home/ivieira/mambaforge/lib/python3.12/site-packages/torch/__init__.py", line 367, in <module>
    from torch._C import *  # noqa: F403
    ^^^^^^^^^^^^^^^^^^^^^^
ImportError: libcudnn.so.9: cannot open shared object file: No such file or directory
PyTorch CUDA installation failed, trying conda...
Channels:
 - pytorch
 - nvidia
 - conda-forge
Platform: linux-64
Collecting package metadata (repodata.json): ...working... done
Solving environment: ...working... done

## Package Plan ##

  environment location: /home/ivieira/mambaforge

  added / updated specs:
    - pytorch
    - pytorch-cuda=11.8
    - torchaudio
    - torchvision


The following packages will be downloaded:

    package                    |            build
    ---------------------------|-----------------
    certifi-2024.12.14         |     pyhd8ed1ab_0         158 KB  conda-forge
    conda-24.11.2              |  py312h7900ff3_1         1.1 MB  conda-forge
    cpython-3.12.7             |  py312hd8ed1ab_0          44 KB  conda-forge
    filelock-3.16.1            |     pyhd8ed1ab_1          17 KB  conda-forge
    gmpy2-2.1.5                |  py312h7201bc8_3         205 KB  conda-forge
    jinja2-3.1.5               |     pyhd8ed1ab_0         110 KB  conda-forge
    markupsafe-3.0.2           |  py312h178313f_1          24 KB  conda-forge
    mpmath-1.3.0               |     pyhd8ed1ab_1         429 KB  conda-forge
    networkx-3.4.2             |     pyh267e887_2         1.2 MB  conda-forge
    numpy-2.2.1                |  py312h7e784f5_0         8.1 MB  conda-forge
    pillow-11.1.0              |  py312h80c1187_0        40.8 MB  conda-forge
    pytorch-2.5.1              |py3.12_cuda11.8_cudnn9.1.0_0        1.55 GB  pytorch
    pyyaml-6.0.2               |  py312h66e93f0_1         202 KB  conda-forge
    sympy-1.13.3               |   pyh2585a3b_105         4.3 MB  conda-forge
    torchaudio-2.5.1           |      py312_cu118         6.4 MB  pytorch
    torchtriton-3.1.0          |            py312       233.6 MB  pytorch
    torchvision-0.20.1         |      py312_cu118         8.5 MB  pytorch
    typing_extensions-4.12.2   |     pyha770c72_1          39 KB  conda-forge
    ------------------------------------------------------------
                                           Total:        1.85 GB

The following NEW packages will be INSTALLED:

  aom                conda-forge/linux-64::aom-3.6.1-h59595ed_0 
  blas               conda-forge/linux-64::blas-2.116-mkl 
  blas-devel         conda-forge/linux-64::blas-devel-3.9.0-16_linux64_mkl 
  cpython            conda-forge/noarch::cpython-3.12.7-py312hd8ed1ab_0 
  cuda-cudart        nvidia/linux-64::cuda-cudart-11.8.89-0 
  cuda-cupti         nvidia/linux-64::cuda-cupti-11.8.87-0 
  cuda-libraries     nvidia/linux-64::cuda-libraries-11.8.0-0 
  cuda-nvrtc         nvidia/linux-64::cuda-nvrtc-11.8.89-0 
  cuda-nvtx          nvidia/linux-64::cuda-nvtx-11.8.86-0 
  cuda-runtime       nvidia/linux-64::cuda-runtime-11.8.0-0 
  cuda-version       nvidia/noarch::cuda-version-12.6-3 
  ffmpeg             conda-forge/linux-64::ffmpeg-4.4.2-gpl_hdf48244_113 
  filelock           conda-forge/noarch::filelock-3.16.1-pyhd8ed1ab_1 
  font-ttf-dejavu-s~ conda-forge/noarch::font-ttf-dejavu-sans-mono-2.37-hab24e00_0 
  font-ttf-inconsol~ conda-forge/noarch::font-ttf-inconsolata-3.000-h77eed37_0 
  font-ttf-source-c~ conda-forge/noarch::font-ttf-source-code-pro-2.038-h77eed37_0 
  font-ttf-ubuntu    conda-forge/noarch::font-ttf-ubuntu-0.83-h77eed37_3 
  fontconfig         conda-forge/linux-64::fontconfig-2.15.0-h7e30c49_1 
  fonts-conda-ecosy~ conda-forge/noarch::fonts-conda-ecosystem-1-0 
  fonts-conda-forge  conda-forge/noarch::fonts-conda-forge-1-0 
  freetype           conda-forge/linux-64::freetype-2.12.1-h267a509_2 
  gettext            conda-forge/linux-64::gettext-0.22.5-he02047a_3 
  gettext-tools      conda-forge/linux-64::gettext-tools-0.22.5-he02047a_3 
  giflib             conda-forge/linux-64::giflib-5.2.2-hd590300_0 
  gmp                conda-forge/linux-64::gmp-6.3.0-hac33072_2 
  gmpy2              conda-forge/linux-64::gmpy2-2.1.5-py312h7201bc8_3 
  gnutls             conda-forge/linux-64::gnutls-3.7.9-hb077bed_0 
  jinja2             conda-forge/noarch::jinja2-3.1.5-pyhd8ed1ab_0 
  lame               conda-forge/linux-64::lame-3.100-h166bdaf_1003 
  lcms2              conda-forge/linux-64::lcms2-2.16-hb7c19ff_0 
  lerc               conda-forge/linux-64::lerc-4.0.0-h27087fc_0 
  libasprintf        conda-forge/linux-64::libasprintf-0.22.5-he8f35ee_3 
  libasprintf-devel  conda-forge/linux-64::libasprintf-devel-0.22.5-he8f35ee_3 
  libblas            conda-forge/linux-64::libblas-3.9.0-16_linux64_mkl 
  libcblas           conda-forge/linux-64::libcblas-3.9.0-16_linux64_mkl 
  libcublas          nvidia/linux-64::libcublas-11.11.3.6-0 
  libcufft           nvidia/linux-64::libcufft-10.9.0.58-0 
  libcufile          nvidia/linux-64::libcufile-1.11.1.6-0 
  libcurand          nvidia/linux-64::libcurand-10.3.7.77-0 
  libcusolver        nvidia/linux-64::libcusolver-11.4.1.48-0 
  libcusparse        nvidia/linux-64::libcusparse-11.7.5.86-0 
  libdeflate         conda-forge/linux-64::libdeflate-1.23-h4ddbbb0_0 
  libdrm             conda-forge/linux-64::libdrm-2.4.124-hb9d3cd8_0 
  libegl             conda-forge/linux-64::libegl-1.7.0-ha4b6fd6_2 
  libgettextpo       conda-forge/linux-64::libgettextpo-0.22.5-he02047a_3 
  libgettextpo-devel conda-forge/linux-64::libgettextpo-devel-0.22.5-he02047a_3 
  libgfortran        conda-forge/linux-64::libgfortran-14.2.0-h69a702a_1 
  libgfortran-ng     conda-forge/linux-64::libgfortran-ng-14.2.0-h69a702a_1 
  libgfortran5       conda-forge/linux-64::libgfortran5-14.2.0-hd5240d6_1 
  libgl              conda-forge/linux-64::libgl-1.7.0-ha4b6fd6_2 
  libglvnd           conda-forge/linux-64::libglvnd-1.7.0-ha4b6fd6_2 
  libglx             conda-forge/linux-64::libglx-1.7.0-ha4b6fd6_2 
  libhwloc           conda-forge/linux-64::libhwloc-2.11.2-default_h0d58e46_1001 
  libidn2            conda-forge/linux-64::libidn2-2.3.7-hd590300_0 
  libjpeg-turbo      conda-forge/linux-64::libjpeg-turbo-3.0.0-hd590300_1 
  liblapack          conda-forge/linux-64::liblapack-3.9.0-16_linux64_mkl 
  liblapacke         conda-forge/linux-64::liblapacke-3.9.0-16_linux64_mkl 
  liblzma            conda-forge/linux-64::liblzma-5.6.3-hb9d3cd8_1 
  libnpp             nvidia/linux-64::libnpp-11.8.0.86-0 
  libnvjpeg          nvidia/linux-64::libnvjpeg-11.9.0.86-0 
  libpciaccess       conda-forge/linux-64::libpciaccess-0.18-hd590300_0 
  libpng             conda-forge/linux-64::libpng-1.6.44-hadc24fc_0 
  libtasn1           conda-forge/linux-64::libtasn1-4.19.0-h166bdaf_0 
  libtiff            conda-forge/linux-64::libtiff-4.7.0-hd9ff511_3 
  libunistring       conda-forge/linux-64::libunistring-0.9.10-h7f98852_0 
  libva              conda-forge/linux-64::libva-2.22.0-h8a09558_1 
  libvpx             conda-forge/linux-64::libvpx-1.13.1-h59595ed_0 
  libwebp            conda-forge/linux-64::libwebp-1.5.0-hae8dbeb_0 
  libwebp-base       conda-forge/linux-64::libwebp-base-1.5.0-h851e524_0 
  libxcb             conda-forge/linux-64::libxcb-1.17.0-h8a09558_0 
  llvm-openmp        conda-forge/linux-64::llvm-openmp-15.0.7-h0cdce71_0 
  markupsafe         conda-forge/linux-64::markupsafe-3.0.2-py312h178313f_1 
  mkl                conda-forge/linux-64::mkl-2022.1.0-h84fe81f_915 
  mkl-devel          conda-forge/linux-64::mkl-devel-2022.1.0-ha770c72_916 
  mkl-include        conda-forge/linux-64::mkl-include-2022.1.0-h84fe81f_915 
  mpc                conda-forge/linux-64::mpc-1.3.1-h24ddda3_1 
  mpfr               conda-forge/linux-64::mpfr-4.2.1-h90cbb55_3 
  mpmath             conda-forge/noarch::mpmath-1.3.0-pyhd8ed1ab_1 
  nettle             conda-forge/linux-64::nettle-3.9.1-h7ab15ed_0 
  networkx           conda-forge/noarch::networkx-3.4.2-pyh267e887_2 
  numpy              conda-forge/linux-64::numpy-2.2.1-py312h7e784f5_0 
  openh264           conda-forge/linux-64::openh264-2.3.1-hcb278e6_2 
  openjpeg           conda-forge/linux-64::openjpeg-2.5.3-h5fbd93e_0 
  p11-kit            conda-forge/linux-64::p11-kit-0.24.1-hc5aa10d_0 
  pillow             conda-forge/linux-64::pillow-11.1.0-py312h80c1187_0 
  pthread-stubs      conda-forge/linux-64::pthread-stubs-0.4-hb9d3cd8_1002 
  pytorch            pytorch/linux-64::pytorch-2.5.1-py3.12_cuda11.8_cudnn9.1.0_0 
  pytorch-cuda       pytorch/linux-64::pytorch-cuda-11.8-h7e8668a_6 
  pytorch-mutex      pytorch/noarch::pytorch-mutex-1.0-cuda 
  pyyaml             conda-forge/linux-64::pyyaml-6.0.2-py312h66e93f0_1 
  svt-av1            conda-forge/linux-64::svt-av1-1.4.1-hcb278e6_0 
  sympy              conda-forge/noarch::sympy-1.13.3-pyh2585a3b_105 
  tbb                conda-forge/linux-64::tbb-2021.13.0-hceb3a55_1 
  torchaudio         pytorch/linux-64::torchaudio-2.5.1-py312_cu118 
  torchtriton        pytorch/linux-64::torchtriton-3.1.0-py312 
  torchvision        pytorch/linux-64::torchvision-0.20.1-py312_cu118 
  typing_extensions  conda-forge/noarch::typing_extensions-4.12.2-pyha770c72_1 
  wayland            conda-forge/linux-64::wayland-1.23.1-h3e06ad9_0 
  wayland-protocols  conda-forge/noarch::wayland-protocols-1.37-hd8ed1ab_0 
  x264               conda-forge/linux-64::x264-1!164.3095-h166bdaf_2 
  x265               conda-forge/linux-64::x265-3.5-h924138e_3 
  xorg-libx11        conda-forge/linux-64::xorg-libx11-1.8.10-h4f16b4b_1 
  xorg-libxau        conda-forge/linux-64::xorg-libxau-1.0.12-hb9d3cd8_0 
  xorg-libxdmcp      conda-forge/linux-64::xorg-libxdmcp-1.1.5-hb9d3cd8_0 
  xorg-libxext       conda-forge/linux-64::xorg-libxext-1.3.6-hb9d3cd8_0 
  xorg-libxfixes     conda-forge/linux-64::xorg-libxfixes-6.0.1-hb9d3cd8_0 
  yaml               conda-forge/linux-64::yaml-0.2.5-h7f98852_2 

The following packages will be UPDATED:

  ca-certificates                      2024.8.30-hbcca054_0 --> 2024.12.14-hbcca054_0 
  certifi                            2024.8.30-pyhd8ed1ab_0 --> 2024.12.14-pyhd8ed1ab_0 
  conda                              24.9.2-py312h7900ff3_0 --> 24.11.2-py312h7900ff3_1 
  openssl                                  3.4.0-hb9d3cd8_0 --> 3.4.0-h7b32b05_1 

The following packages will be DOWNGRADED:

  _openmp_mutex                                   4.5-2_gnu --> 4.5-2_kmp_llvm 



Downloading and Extracting Packages: ...working... done
Preparing transaction: ...working... done
Verifying transaction: ...working... done
Executing transaction: ...working... done
Traceback (most recent call last):
  File "<string>", line 1, in <module>
AssertionError: PyTorch CUDA still not available
